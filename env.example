# =============================================================================
# MLflow Self-Hosted Server Configuration
# =============================================================================
# Copy this file to .env and modify values as needed
# cp env.example .env

# =============================================================================
# PostgreSQL Configuration
# =============================================================================
# Database credentials for MLflow metadata store
# Change these in production!

# PostgreSQL username
POSTGRES_USER=mlflow

# PostgreSQL password (CHANGE THIS IN PRODUCTION!)
POSTGRES_PASSWORD=mlflow

# PostgreSQL database name
POSTGRES_DB=mlflow

# PostgreSQL port (exposed to host)
POSTGRES_PORT=5432

# =============================================================================
# MinIO Configuration
# =============================================================================
# S3-compatible object storage for MLflow artifacts
# Change credentials in production!

# MinIO root user (access key)
MINIO_ROOT_USER=minioadmin

# MinIO root password (secret key) (CHANGE THIS IN PRODUCTION!)
MINIO_ROOT_PASSWORD=minioadmin

# MinIO API port (S3-compatible endpoint)
MINIO_PORT=9000

# MinIO Console port (Web UI)
MINIO_CONSOLE_PORT=9001

# MinIO bucket name for MLflow artifacts
MINIO_BUCKET_NAME=mlflow-artifacts

# =============================================================================
# MLflow Server Configuration
# =============================================================================
# MLflow tracking server settings

# MLflow UI and API port
MLFLOW_PORT=5000

# Number of worker processes for MLflow server
# Increase for higher load (default: 4)
MLFLOW_WORKERS=4

# Storage Backend Selection
# Set to "local" to use local filesystem storage (no internet required, offline-friendly)
# Set to "s3" to use S3-compatible MinIO storage (default, requires MinIO service)
# Options: "local" or "s3"
STORAGE_BACKEND=s3

# Artifact storage root path (OPTIONAL - automatically set based on STORAGE_BACKEND)
# The entrypoint script will automatically set this based on STORAGE_BACKEND:
#   - If STORAGE_BACKEND=local: uses file:/app/mlruns
#   - If STORAGE_BACKEND=s3: uses s3://${MINIO_BUCKET_NAME}/
# Only set this if you need to override the automatic selection
# Examples:
#   MLFLOW_ARTIFACT_ROOT=file:/app/mlruns          # Local storage
#   MLFLOW_ARTIFACT_ROOT=s3://mlflow-artifacts/    # S3/MinIO storage
# MLFLOW_ARTIFACT_ROOT=

# =============================================================================
# AWS S3 Configuration (for MinIO compatibility)
# =============================================================================
# These are used when MLflow interacts with S3-compatible storage (MinIO)

# AWS access key (same as MINIO_ROOT_USER for MinIO)
AWS_ACCESS_KEY_ID=minioadmin

# AWS secret key (same as MINIO_ROOT_PASSWORD for MinIO)
AWS_SECRET_ACCESS_KEY=minioadmin

# AWS region (required for S3 operations, but not used by MinIO)
AWS_DEFAULT_REGION=us-east-1

# S3 endpoint URL (MinIO endpoint)
# For local MinIO: http://minio:9000 (internal) or http://localhost:9000 (external)
MLFLOW_S3_ENDPOINT_URL=http://minio:9000

# =============================================================================
# Optional: Local Storage Configuration
# =============================================================================
# Uncomment and modify if you want to use local filesystem instead of S3/MinIO
# Also update docker-compose.yml to use file:// path

# MLFLOW_ARTIFACT_ROOT=file:/app/mlruns

# =============================================================================
# Production Recommendations
# =============================================================================
# For production deployments:
# 1. Use strong, unique passwords for POSTGRES_PASSWORD and MINIO_ROOT_PASSWORD
# 2. Consider using Docker secrets or external secret management
# 3. Set appropriate resource limits in docker-compose.prod.yml
# 4. Enable SSL/TLS for PostgreSQL and MinIO
# 5. Use reverse proxy (nginx/traefik) for MLflow UI
# 6. Set up regular backups for PostgreSQL and MinIO data
# 7. Monitor disk usage and set up alerts
# 8. Use environment-specific .env files (.env.prod, .env.staging)
